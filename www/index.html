<!doctype html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <link rel="stylesheet" href="css/jquerymobile.css" />
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/jquery.mobile.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
</head>
<body>
    <body>
        <!-- MAIN PAGE -->
        <div data-role="page" id="main-page">
            <!-- panel:user informatino -->
            <div data-role="panel" id="menu-panel">
                <p class="uid">Guest User:D</p>
                <ul data-role="listview" data-inset="true">
                    <li><a href="#main-page" data-rel="close">home</a></li>
                    <li><a href="#login-page">login</a></li>
                    <li><a href="#phonegap-page">phonegap APIs</a></li>
                    <li><a href="#about">about</a></li>
                </ul>
            </div>

            <div data-role="header">
                <a href="#menu-panel" class="ui-btn ui-corner-all ui-icon-bars ui-btn-icon-notext">panel</a>
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                <p>phonegap API test!!</p>
            </div>

            <div data-role="footer">
                <h1>copyright@sungmin</h1>
            </div>

        </div>

        <!-- LOGIN PAGE -->
        <div data-role="page" data-dialog="true" id="login-page">
            <div data-role="header">
                <h1>this page is login form</h1>
            </div>

            <div dat-role="main" class="ui-content">
                <form action="" method="post">
                    <input type="text" name="user-name" id="user-name" placeholder="input user ID">
                    <input type="password" name="user-pwd" id="user-pwd" placeholder="input password">
                    <input id="logint-submit" type="submit" value="submit">
                </form>

            </div>
        </div>

        <!-- PHONEGAP APIS PAGE -->
        <div data-role="page" id="phonegap-page">

            <!-- panel:user informatino -->
            <div data-role="panel" id="menu-panel1">
                <p class="uid">Guest User:D</p>
                <ul data-role="listview" data-inset="true">
                    <li><a href="#main-page">home</a></li>
                    <li><a href="#login-page">login</a></li>
                    <li><a href="#phonegap-page" data-rel="close">phonegap APIs</a></li>
                    <li><a href="#chat-page">chat service</a></li>
                    <li><a href="#about">about</a></li>
                </ul>
            </div>

            <div data-role="header">
                <a href="#menu-panel1" class="ui-btn ui-corner-all ui-icon-bars ui-btn-icon-notext">panel</a>
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                <form class="ui-filterable">
                    <input id="my-filter" data-type="search" placeholder="Search Phongap API's Sample">
                </form>
                <ul data-role="listview" data-filter="true" data-input="#my-filter" data-inset="true">
                    <li><a href="#phonegap-device">device</a></li>
                    <li><a href="#phonegap-geolocation">geolocation</a></li>
                    <li><a href="#phonegap-notification">notification</a></li>
                    <li><a href="#phonegap-vibration">vibration</a></li>
                    <li><a href="#phonegap-network">network-information</a></li>
                    <li><a href="#phonegap-motion">device-motion</a></li>
                    <li><a href="#">item2</a></li>
                    <li><a href="#">item3</a></li>
                    <li><a href="#">item4</a></li>
                    <li><a href="#">item5</a></li>
                </ul>
            </div>

            <div data-role="footer">
                <h1>copyright@sungmin</h1>
            </div>
        </div>

        <!-- API Device -->
        <div data-role="page" id="phonegap-device">
            <div data-role="header">
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                <ul data-role="listview" data-inset="inset">
                    <li id="device1"></li>
                    <li id="device2"></li>
                    <li id="device3"></li>
                    <li id="device4"></li>
                    <li id="device5"></li>
                    <li id="device6"></li>
                </ul>
            </div>
        </div>

        <!-- API Geolocation -->
        <div data-role="page" id="phonegap-geolocation">
            <div data-role="header">
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                <button id="geolocation1">getCurrentPosition</button>
            </div>
        </div>

        <!-- API Notification -->
        <div data-role="page" id="phonegap-notification">
            <div data-role="header">
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                <button id="notification1">alert</button>
                <button id="notification2">beep</button>
            </div>
        </div>

        <!-- API Vibration -->
        <div data-role="page" id="phonegap-vibration">
            <div data-role="header">
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                <button id="vibration1">default</button>
                <button id="vibration2">cancel</button>
                <button id="vibration3">pattern</button>

            </div>
        </div>

        <!-- API Netwrok -->
        <div data-role="page" id="phonegap-network">
            <div data-role="header">
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                <button id="network1">network info</button>
                <button id="network2">network conected?</button>
            </div>
        </div>

        <!-- MOTION Netwrok -->
        <div data-role="page" id="phonegap-motion">
            <div data-role="header">
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                <button id="motion1">getCurrentAcceleration</button>
                <button id="motion2">watchAcceleration</button>
                <hr>
                <p id="motion2-result">watchAcceleration result</p>
                <hr>
                <button id="motion3">clearAcceleration</button>
            </div>
        </div>

        <!-- chat -->
        <div data-role="page" id="chat-page">
            <div data-role="header">
                <h1>Gnal's Project</h1>
            </div>

            <div data-role="main" class="ui-content">
                welcome
            </div>
        </div>


        <script type="text/javascript">
        app.initialize();

        (function login(){
            var user = {id:'root',pw:'1234'};
            $('#logint-submit').on('click',function(e){
                e.preventDefault();

                var $name = $('#user-name').val();
                var $pwd = $('#user-pwd').val();

                if($name == '' || $pwd == '') {
                    alert('input id/pw');
                    return;
                }

                if($name == user.id && $pwd == user.pw) {
                    procLogin(user.id);
                } else {
                    alert('fail');
                }
            });
        })();

        (function checkLogin(uid){
            if(uid) procLogin(uid);
        })(localStorage.getItem('user-id'));

        function procLogin(uid){
            localStorage.setItem('user-id', uid);

            alert('welcome,'+uid+'!');
            $('.uid').html('welcome,'+localStorage.getItem('user-id')+'!');

            location.href = location.pathname + '#main-page';
        }

        function redirect(where){
            return url = location.href.split('#')[0] + where;
        }

        // device API
        document.addEventListener("deviceready", deviceAPIs, false);
        function deviceAPIs() {
            $('#device1').html(device.cordova);
            $('#device2').html(device.model);
            $('#device3').html(device.name);
            $('#device4').html(device.platform);
            $('#device5').html(device.uuid);
            $('#device6').html(device.version);
        }

        // geolocation API
        $('#geolocation1').on('click', geolocation1);
        function geolocation1(){
            var onSuccess = function(position) {
                alert('Latitude: '          + position.coords.latitude          + '\n' +
                    'Longitude: '         + position.coords.longitude         + '\n' +
                    'Altitude: '          + position.coords.altitude          + '\n' +
                    'Accuracy: '          + position.coords.accuracy          + '\n' +
                    'Altitude Accuracy: ' + position.coords.altitudeAccuracy  + '\n' +
                    'Heading: '           + position.coords.heading           + '\n' +
                    'Speed: '             + position.coords.speed             + '\n' +
                    'Timestamp: '         + position.timestamp                + '\n');
            };
            function onError(error) {
                alert('code: '    + error.code    + '\n' +
                    'message: ' + error.message + '\n');
            }

            navigator.geolocation.getCurrentPosition(onSuccess, onError);
        }

        // notification API
        $('#notification1').on('click',notification1);
        $('#notification2').on('click',notification2);
        function notification1(){
            function alertDismissed() {
                alert('default alert');
            }

            navigator.notification.alert(
                'hi, this is custom alert',  // message
                alertDismissed,         // callback
                'custom alert',            // title
                '????'                  // buttonName
                );
        }
        function notification2(){
            navigator.notification.beep(2); // Beep twice!
        }

        $('#vibration1').on('click', vibration1);
        $('#vibration2').on('click', vibration2);
        $('#vibration3').on('click', vibration3);
        function vibration1(){
            navigator.notification.vibrate(3000); //option:duration
        }
        function vibration2(){
            navigator.notification.cancelVibration(); //vibration cancel
        }
        function vibration3(){
            navigator.notification.vibrateWithPattern([
                0, 100, 100, 200, 100, 400, 100, 800 
            ]);//vibration pattern : Immediately start > duration 100 > wating 100 > durtaion 200 > wating 100 ...
        }

        // network-information
        // 오프라인일떄 팅기는 버그 있음(플러그인 문제)
        $('#network1').on('click', checkConnection);
        function checkConnection() {
            var networkState = navigator.connection.type;

            var states = {};
            states[Connection.UNKNOWN]  = 'Unknown connection';
            states[Connection.ETHERNET] = 'Ethernet connection';
            states[Connection.WIFI]     = 'WiFi connection';
            states[Connection.CELL_2G]  = 'Cell 2G connection';
            states[Connection.CELL_3G]  = 'Cell 3G connection';
            states[Connection.CELL_4G]  = 'Cell 4G connection';
            states[Connection.CELL]     = 'Cell generic connection';
            states[Connection.NONE]     = 'No network connection';

            alert('Connection type: ' + states[networkState]);
        }

        var is_online = 'this is offline';
        document.addEventListener("offline", onOffline, false); // offline listener
        document.addEventListener("online", onOnline, false); // online listener

        function onOffline(){
            is_online = 'this is offline';
        }
        function onOnline(){
            is_online = 'this is online';
        }
        $('#network2').on('click', isOnline);
        function isOnline(){
            alert(is_online);
        }

        // MOTION(Acceleration) API
        $('#motion1').on('click', motion1);
        function motion1(){
            function onSuccess(acceleration) {
                alert('Acceleration X: ' + acceleration.x + '\n' +
                  'Acceleration Y: ' + acceleration.y + '\n' +
                  'Acceleration Z: ' + acceleration.z + '\n' +
                  'Timestamp: '      + acceleration.timestamp + '\n');
            };

            function onError() {
                alert('onError!');
            };

            navigator.accelerometer.getCurrentAcceleration(onSuccess, onError);
        }

        $('#motion2').on('click', motion2);
        var watchID = 0;
        function motion2(){
            function onSuccess(acceleration){ 
                $('#motion2-result').html(
                    'watchID: ' + watchID + '\n' +
                    'Acceleration X: ' + acceleration.x + '\n' +
                    'Acceleration Y: ' + acceleration.y + '\n' +
                    'Acceleration Z: ' + acceleration.z + '\n' +
                    'Timestamp: '      + acceleration.timestamp + '\n');
            };

            function onError() {
                alert('onError!');
            };

            var options = { frequency: 3000 };  // Update every 3 seconds

            watchID = navigator.accelerometer.watchAcceleration(onSuccess, onError, options);
        }

        $('#motion3').on('click', motion3);
        function motion3(){
            alert('watchID : ' + watchID);
            navigator.accelerometer.clearWatch(watchID);
        }
        </script>
    </body>
</body>
</html>